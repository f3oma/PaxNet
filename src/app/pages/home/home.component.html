<div class="home-container">
  <div class="primary-content">
    <div class="content" *ngIf="isLoggedIn; else loggedOut">
      <h4 class="quick-actions-header">Quick actions</h4>
      <div class="quick-actions">
        <div class="hasClaimedData" *ngIf="hasClaimedData">
          <div id="search" class="quick-action" [routerLink]="['/search']">
            <div class="icon"><mat-icon>search</mat-icon></div>
            <div class="title">Search PAX</div>
          </div>
          <div id="addPax" class="quick-action" [routerLink]="['/add-pax']">
            <div class="icon"><mat-icon>person_add</mat-icon></div>
            <div class="title">Add an FNG</div>
          </div>
          <div id="logWorkout" class="quick-action" (click)="reportAttendance()">
            <div class="icon"><mat-icon>directions_run</mat-icon></div>
            <div class="title">Log Workout</div>
          </div>
          <div id="weeklySchedule" class="quick-action" [routerLink]="['/weekly-schedule']">
            <div class="icon"><mat-icon>list</mat-icon></div>
            <div class="title">Weekly Q Schedule</div>
          </div>
          <div id="qScheduler" *ngIf="isAdminOrSiteQ" class="quick-action" [routerLink]="['/admin/q-scheduler']">
            <div class="icon"><mat-icon>calendar_month</mat-icon></div>
            <div class="title">Q-Scheduler</div>
          </div>
        </div>
        <div class="dataNotClaimed" *ngIf="!hasClaimedData">
          <div id="claimMyData" class="quick-action" [routerLink]="['/settings']">
            <div class="icon"></div>
            <div class="title">Claim my Data</div>
          </div>
        </div>
      </div>
      <div class="attendance-report-required" *ngIf="hasClaimedData && beatdownsRequiringAttendanceData && beatdownsRequiringAttendanceData.length > 0">
        <h4 class="report-attendance-header">Report Beatdown Attendance</h4>
        <p>It looks like you might have Q'd recently, please report attendance.</p>
        <div class="report-attendance-buttons">
          <ng-container *ngFor="let attendance of beatdownsRequiringAttendanceData">
            <div class="alreadyReported" *ngIf="attendance.isReported">
              <p><i>Attendance at {{attendance.beatdown.eventName ? attendance.beatdown.eventName : attendance.beatdown.aoLocation?.name }} has been reported ({{attendance.paxCount}})</i></p>
            </div>
            <button *ngIf="!attendance.isReported" mat-button class="report-attendance-btn" (click)="reportCommunityBeatdownAttendance(attendance.beatdown)">
              <b>{{attendance.beatdown.eventName ? attendance.beatdown.eventName : attendance.beatdown.aoLocation?.name }}</b> - {{attendance.beatdown.date | date: 'fullDate'}}<mat-icon>notification_important</mat-icon>
            </button>
          </ng-container>
        </div>
      </div>
      <div class="upcoming-qs" *ngIf="hasClaimedData && upcomingQs.length > 0">
        <h4 class="upcoming-qs-header">My Upcoming Q's</h4>
        <ul>
            <li *ngFor="let beatdown of upcomingQs">{{beatdown.date | date: 'fullDate'}} at <b>{{beatdown.eventName ? beatdown.eventName : beatdown.aoLocation?.name }}</b></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="side-container" *ngIf="isLoggedIn">
    <div class="new-pax" *ngIf="latestPax && latestPax.length > 0" @fadeInOut>
      <h4>New Pax</h4>
      <div class="recent-pax-list">
        <div class="pax-line" *ngFor="let pax of latestPax" [routerLink]="['/users/' + pax.id]">
          <div class="pax-data">
            <div class="header">
              <div *ngIf="pax.profilePhotoUrl" class="current-profile-img" [style.background-image]="'url(' + pax.profilePhotoUrl + ')'" [ngClass]="{ 'defaultBackground': !pax.profilePhotoUrl }"></div>
              <h5>{{pax.f3Name}}</h5>
            </div>
            <p>EH'd at: <b>{{pax.ehLocationName}}</b></p>
            <p>EH'd by: <b>{{pax.ehUserF3Name}}</b></p>
          </div>
          <div class="welcome">
            <p id="welcome-text">WELCOME!</p>
          </div>
        </div>
      </div>
    </div>
    <div class="new-pax" *ngIf="anniversaryPax && anniversaryPax.length > 0" @fadeInOut>
      <h4>Weekly Anniversaries</h4>
      <p class="anniversaryDate">{{anniversaryStartDate | date: "MM/dd"}} - {{anniversaryEndDate | date: "MM/dd"}}</p>
      <div class="recent-pax-list">
        <div class="pax-line" *ngFor="let pax of anniversaryPax" [routerLink]="['/users/' + pax.id]">
          <div class="pax-data">
            <div class="header">
              <div *ngIf="pax.profilePhotoUrl" class="current-profile-img" [style.background-image]="'url(' + pax.profilePhotoUrl + ')'" [ngClass]="{ 'defaultBackground': !pax.profilePhotoUrl }"></div>
              <h5>{{pax.f3Name}}</h5>
            </div>
            <p>{{pax.fullName}}</p>
            <p>Joined: {{pax.joinDate | date: 'MM-dd-YYYY'}}</p>
          </div>
          <div class="welcome">
            <p id="welcome-text">{{pax.anniversaryYear}} YEAR</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<ng-template #loggedOut>
  <div class="content">
    <h2><b>Welcome to F3 Omaha's PaxNet!</b></h2>
    <p>To get started and join the community, please use the button below to get authenticated.</p>
    <button *ngIf="!isLoggedIn" mat-button id="login-btn" class="action-btn" [routerLink]="['/login']">Log in to continue<mat-icon>lock</mat-icon></button>
  </div>
</ng-template>